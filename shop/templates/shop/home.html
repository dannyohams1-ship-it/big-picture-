{% extends "shop/base.html" %}
{% load static %}
{% load currency_tags %}

{% block content %}
<div class="hero-section position-relative">
  <!-- Background Image -->
  <img src="{% static 'shop/images/background.jpg' %}" 
       alt="Luxury Hair Extensions" 
       class="w-100 d-block hero-image" 
       style="height: 85vh; object-fit: cover;">

  <!-- Overlay -->
  <div class="overlay position-absolute top-0 start-0 w-100 h-100" 
       style="background: rgba(0,0,0,0.45);"></div>

  <!-- Hero Content -->
  <div class="hero-content position-absolute top-50 start-50 translate-middle text-center text-light px-3">
    <h1 class="fw-bold display-4 text-warning">Luchi Addiction</h1>
    <p class="lead fw-semibold mb-3">Premium Wigs Â· HD Laces Â· Hair Extensions</p>
    <p class="fst-italic fw-light mb-4">âœ¨ Confidence in Every Strand âœ¨</p>
    <a href="/products/" class="btn btn-lg btn-warning fw-semibold shadow">Shop Now</a>
  </div>
</div>

<!-- ðŸŒŸ BEST SELLERS SECTION -->
<div class="container my-5">
  <h2 class="text-center fw-bold mb-4" data-aos="fade-up">ðŸŒŸ Best Sellers</h2>
  
  <div class="row g-4">
    {% for product in best_sellers %}
      <div class="col-6 col-md-3 col-lg-2">
        <div class="product-card shadow-lg border-0 position-relative p-3 rounded-4" data-aos="zoom-in" data-aos-delay="{{ forloop.counter0|add:1 }}00">
          
          <!-- Badge -->
          <span class="badge bg-warning text-dark position-absolute top-0 start-0 m-2 rounded-pill px-3 py-2 shadow">
            ðŸ”¥ Best Seller
          </span>

          <!-- Product Image -->
          <div class="product-img-wrapper">
            <a href="{% url 'product_detail' product.id %}">
              <img src="{{ product.image.url }}" class="img-fluid rounded-4" alt="{{ product.name }}">
            </a>
          </div>

          <!-- Product Info -->
          <div class="text-center mt-3">
            <h6 class="fw-bold">{{ product.name }}</h6>
            <p class="text-muted mb-2">
              {{ product.price|as_currency:request.session.currency }}
            </p>


            <!-- Add to Cart -->
            <form method="post" action="{% url 'add_to_cart' product.id %}">
              {% csrf_token %}
              <button type="submit" class="btn btn-gradient w-100 fw-bold">Add to Cart</button>
            </form>
          </div>
        </div>
      </div>
    {% empty %}
      <p class="text-center text-muted">No best sellers added yet.</p>
    {% endfor %}
  </div>
</div>

<!-- ðŸŒŸ STYLING -->
<style>
.product-card {
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(15px);
  transition: all 0.3s ease;
}
.product-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}
.product-img-wrapper {
  overflow: hidden;
  border-radius: 15px;
}
.product-img-wrapper img {
  transition: transform 0.4s ease;
}
.product-card:hover img {
  transform: scale(1.08);
}
.btn-gradient {
  background: linear-gradient(135deg, #f7b733, #fc4a1a);
  color: #fff;
  border: none;
  transition: 0.3s ease;
}
.btn-gradient:hover {
  background: linear-gradient(135deg, #fc4a1a, #f7b733);
  transform: scale(1.05);
}
</style>

<!-- ðŸš€ NEW ARRIVALS SECTION -->
<div class="container my-5">
  <h2 class="text-center fw-bold mb-4" data-aos="fade-up">ðŸš€ New Arrivals</h2>
  
 <div class="new-scroll">
  {% for product in new_arrivals %}
    <div class="new-card p-3 rounded-3 text-center" data-aos="zoom-in-up" data-aos-delay="{{ forloop.counter0|add:1 }}00">
          
          <!-- Product Image -->
          <div class="new-img-wrapper mb-2">
            <a href="{% url 'product_detail' product.id %}">
              <img src="{{ product.image.url }}" alt="{{ product.name }}">
            </a>
          </div>

          <!-- Product Info -->
          <h6 class="new-title">{{ product.name }}</h6>
          <p class="new-price">
            {{ product.price|as_currency:request.session.currency }}
          </p>

          <!-- Add to Cart -->
          <form method="post" action="{% url 'add_to_cart' product.id %}">
            {% csrf_token %}
            <button type="submit" class="btn-cart w-100">ðŸ›’ Add to Cart</button>
          </form>
        </div>
      </div>
    {% empty %}
      <p class="text-center text-muted">No new arrivals yet.</p>
    {% endfor %}
  </div>
</div>

<!-- âœ… CLEAN STYLING -->
<style>
.new-card {
  background: #fff;
  border: 1px solid #eee;
  transition: all 0.3s ease;
}
.new-card:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  transform: translateY(-4px);
}

.new-img-wrapper {
  width: 100%;
  height: 220px; /* desktop standard */
  overflow: hidden;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.new-img-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover; /* keeps all images same size */
  border-radius: 8px;
  transition: transform 0.3s ease;
}
.new-card:hover img {
  transform: scale(1.05);
}

.new-title {
  font-size: 0.95rem;
  font-weight: 600;
  color: #333;
  margin: 6px 0 2px;
}
.new-price {
  font-size: 1rem;
  font-weight: bold;
  color: #d4af37;
}

.btn-cart {
  margin-top: 6px;
  padding: 8px 12px;
  border: none;
  border-radius: 6px;
  background: #000;
  color: #fff;
  font-size: 0.9rem;
  transition: background 0.3s ease;
}
.btn-cart:hover {
  background: #d4af37;
  color: #000;
}

.new-scroll {
  display: flex;
  gap: 16px;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  padding-bottom: 12px;
  -webkit-overflow-scrolling: touch; /* smooth scroll on iOS */
}

.new-scroll::-webkit-scrollbar {
  display: none; /* hide scroll bar for cleaner look */
}

.new-card {
  min-width: 200px;   /* width of each product card */
  flex: 0 0 auto;     /* prevents shrinking */
  scroll-snap-align: start;
  background: #fff;
  border: 1px solid #eee;
  transition: all 0.3s ease;
}

/* âœ… Mobile optimization */
@media (max-width: 768px) {
  .new-img-wrapper {
    height: 160px; /* compact for phones */
  }
}
</style>

<!-- Why Choose Us Section -->
<div class="container my-5">
  <h2 class="text-center fw-bold mb-5 display-6">ðŸŒŸ Why Choose Us</h2>
  <div class="row g-4">
    
    <!-- Card 1 -->
    <div class="col-12 col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="100">
      <div class="card h-100 text-center shadow border-0 rounded-4 p-4 why-card">
        <div class="icon-circle mx-auto mb-3">
          <i class="bi bi-truck fs-2 text-white"></i>
        </div>
        <h5 class="fw-bold">Fast Delivery</h5>
        <p class="text-muted small">Your luxury hair, delivered swiftly and safely.</p>
      </div>
    </div>

    <!-- Card 2 -->
    <div class="col-12 col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="200">
      <div class="card h-100 text-center shadow border-0 rounded-4 p-4 why-card">
        <div class="icon-circle mx-auto mb-3">
          <i class="bi bi-gem fs-2 text-white"></i>
        </div>
        <h5 class="fw-bold">Premium Quality</h5>
        <p class="text-muted small">Handpicked wigs & extensions designed for unmatched elegance.</p>
      </div>
    </div>

    <!-- Card 3 -->
    <div class="col-12 col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="300">
      <div class="card h-100 text-center shadow border-0 rounded-4 p-4 why-card">
        <div class="icon-circle mx-auto mb-3">
          <i class="bi bi-people fs-2 text-white"></i>
        </div>
        <h5 class="fw-bold">Trusted by 500+ Clients</h5>
        <p class="text-muted small">Join our family of satisfied customers who shop with confidence.</p>
      </div>
    </div>

    <!-- Card 4 -->
    <div class="col-12 col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="400">
      <div class="card h-100 text-center shadow border-0 rounded-4 p-4 why-card">
        <div class="icon-circle mx-auto mb-3">
          <i class="bi bi-shield-lock fs-2 text-white"></i>
        </div>
        <h5 class="fw-bold">Secure Payments</h5>
        <p class="text-muted small">Encrypted payment gateways so your transactions stay safe.</p>
      </div>
    </div>

  </div>
</div>

<!-- Custom CSS -->
<style>
  .why-card {
    background: #fff;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .why-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.15);
  }
  .icon-circle {
    width: 70px;
    height: 70px;
    background: linear-gradient(135deg, #f7b733, #fc4a1a);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
  }
</style>

<!-- Scroll Animation (AOS) -->
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
  AOS.init({
    duration: 1000,
    once: true
  });
</script>

<h2 class="text-center my-4">Reviews From Our Customers </h2>

<!-- Mini Slideshow (tiny thumbnails on homepage) -->
<div id="testimonialCarousel" class="carousel slide mx-auto" data-bs-ride="carousel" data-bs-interval="3000" style="max-width: 150px;">
  <div class="carousel-inner rounded shadow">
    <!-- Slide 1 -->
    <div class="carousel-item active">
      <img src="{% static 'images/testimonials/test1.png' %}" 
           class="d-block testimonial-img"
           alt="Testimonial 1">
    </div>

    <!-- Slide 2 -->
    <div class="carousel-item">
      <img src="{% static 'images/testimonials/test2.png' %}" 
           class="d-block testimonial-img"
           alt="Testimonial 2">
    </div>

    <!-- Slide 3 -->
    <div class="carousel-item">
      <img src="{% static 'images/testimonials/test3.png' %}" 
           class="d-block testimonial-img"
           alt="Testimonial 3">
    </div>
    <div class="carousel-item">
      <img src="{% static 'images/testimonials/test4.png' %}" 
           class="d-block testimonial-img"
           alt="Testimonial 4">
    </div>
    <div class="carousel-item">
      <img src="{% static 'images/testimonials/test5.png' %}" 
           class="d-block testimonial-img"
           alt="Testimonial 5">
    </div>
  </div>
</div>

<!-- Expanded Modal Slideshow -->
<div class="modal fade" id="testimonialModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content bg-dark position-relative">
      
      <!-- Close Button -->
      <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-2" data-bs-dismiss="modal" aria-label="Close"></button>
      
      <div class="modal-body p-0">
        <div id="testimonialModalCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
          <div class="carousel-inner">
            <!-- Modal Slide 1 -->
            <div class="carousel-item active">
              <img src="{% static 'images/testimonials/test1.png' %}" class="d-block w-100 modal-img" alt="Testimonial 1">
            </div>
            <!-- Modal Slide 2 -->
            <div class="carousel-item">
              <img src="{% static 'images/testimonials/test2.png' %}" class="d-block w-100 modal-img" alt="Testimonial 2">
            </div>
            <!-- Modal Slide 3 -->
            <div class="carousel-item">
              <img src="{% static 'images/testimonials/test3.png' %}" class="d-block w-100 modal-img" alt="Testimonial 3">
            </div>
          </div>

          <!-- Controls -->
          <button class="carousel-control-prev" type="button" data-bs-target="#testimonialModalCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#testimonialModalCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Custom CSS -->
<style>
  /* Mini carousel images - tiny thumbnails */
  .testimonial-img {
    width: 100px;   /* thumbnail size */
    height: auto;   /* keep aspect ratio */
    margin: 0 auto; /* center in carousel */
    cursor: pointer;
  }

</style>

<!-- JavaScript -->
<script>
  // Sync mini carousel click â†’ open modal at same slide
  document.querySelectorAll(".testimonial-img").forEach((img, index) => {
    img.addEventListener("click", function () {
      let modal = new bootstrap.Modal(document.getElementById("testimonialModal"));
      modal.show();

      let modalCarousel = bootstrap.Carousel.getOrCreateInstance(document.getElementById("testimonialModalCarousel"));
      modalCarousel.to(index);
    });
  });

  // Pause/resume on hold (both carousels)
  function addPauseOnHold(carouselId) {
    let carouselEl = document.querySelector(carouselId);
    let carouselInstance = bootstrap.Carousel.getOrCreateInstance(carouselEl);

    let pressTimer;
    carouselEl.addEventListener("mousedown", () => {
      pressTimer = setTimeout(() => carouselInstance.pause(), 200);
    });
    carouselEl.addEventListener("mouseup", () => {
      clearTimeout(pressTimer);
      carouselInstance.cycle();
    });

    // For touch devices
    carouselEl.addEventListener("touchstart", () => {
      pressTimer = setTimeout(() => carouselInstance.pause(), 200);
    });
    carouselEl.addEventListener("touchend", () => {
      clearTimeout(pressTimer);
      carouselInstance.cycle();
    });
  }

  addPauseOnHold("#testimonialCarousel");
  addPauseOnHold("#testimonialModalCarousel");
</script>

    ...
</div>
{% endblock %}
